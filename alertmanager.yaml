global:
  resolve_timeout: 5m
  # URL del Webhook de Slack (la tuya)
  slack_api_url: 'Pon aqui tu webhook de slack'

route:
  # Agrupar las alertas por nombre, job y severidad
  group_by: ['alertname', 'job', 'severity']
  group_wait: 10s
  group_interval: 1m
  repeat_interval: 10m
  receiver: 'slack-default'
  routes:
    # Ignorar alertas internas
    - match:
        alertname: Watchdog
      receiver: 'null'

    # Enviar alertas crÃ­ticas al canal de crÃ­ticas
    - match:
        severity: 'critical'
      receiver: 'slack-critical'

receivers:
  # Receptor vacÃ­o
  - name: 'null'

  # ðŸ”´ Canal para alertas crÃ­ticas
  - name: 'slack-critical'
    slack_configs:
      - channel: '#cambia tu canal-aqui'
        send_resolved: true
        title: >
          {{ if eq .Status "firing" }}
          ðŸš¨ [{{ .Status | toUpper }}] {{ .CommonLabels.alertname }} ({{ .CommonLabels.severity | toUpper }})
          {{ else }}
          âœ… [{{ .Status | toUpper }}] {{ .CommonLabels.alertname }} ({{ .CommonLabels.severity | toUpper }})
          {{ end }}
        text: >-
          {{ range .Alerts -}}
          *Estado:* `{{ .Status }}`
          *Alerta:* `{{ .Labels.alertname }}`
          *Severidad:* `{{ .Labels.severity }}`
          *DescripciÃ³n:* {{ .Annotations.description }}
          {{ if .Labels.namespace }}*Namespace:* `{{ .Labels.namespace }}`{{ end }}
          {{ if .Labels.pod }}*Pod:* `{{ .Labels.pod }}`{{ end }}
          {{ if .Labels.container }}*Contenedor:* `{{ .Labels.container }}`{{ end }}
          {{ if .Labels.instance }}*Instancia:* `{{ .Labels.instance }}`{{ end }}
          {{ if eq .Status "resolved" }}ðŸŸ¢ *La alerta ha sido resuelta.*{{ end }}
          {{ end }}

  # ðŸ”µ Canal para alertas normales o informativas
  - name: 'slack-default'
    slack_configs:
      - channel: '#cambia tu canal-aqui'
        send_resolved: true
        title: >
          {{ if eq .Status "firing" }}
          ðŸ”” [{{ .Status | toUpper }}] {{ .CommonLabels.alertname }}
          {{ else }}
          âœ… [{{ .Status | toUpper }}] {{ .CommonLabels.alertname }}
          {{ end }}
        text: >-
          {{ range .Alerts -}}
          *Estado:* `{{ .Status }}`
          *DescripciÃ³n:* {{ .Annotations.description }}
          {{ if .Labels.namespace }}*Namespace:* `{{ .Labels.namespace }}`{{ end }}
          {{ if .Labels.pod }}*Pod:* `{{ .Labels.pod }}`{{ end }}
          {{ if eq .Status "resolved" }}ðŸŸ¢ *La alerta ha sido resuelta.*{{ end }}
          {{ end }}

